<div class="feed-container">
  <div class="feed-content">
    <!-- Filtro de Pastoral -->
    <div class="feed-filters">
      <button 
        class="filter-btn" 
        [class.active]="selectedFilter() === 'all'"
        (click)="setFilter('all')"
      >
        <span class="material-icons">public</span>
        Todos
      </button>
      <button 
        class="filter-btn filter-pa" 
        [class.active]="selectedFilter() === 'PA'"
        (click)="setFilter('PA')"
      >
        <span class="material-icons">child_care</span>
        Adolescentes
      </button>
      <button 
        class="filter-btn filter-pj" 
        [class.active]="selectedFilter() === 'PJ'"
        (click)="setFilter('PJ')"
      >
        <span class="material-icons">groups</span>
        Jovens
      </button>
    </div>

    <app-create-post (postCreated)="onPostCreated($event)"></app-create-post>

    @if (isLoading()) {
      <div class="loading-state">
        <div class="spinner"></div>
        <p>Carregando posts...</p>
      </div>
    }

    @if (error()) {
      <div class="error-state">
        <span class="material-icons">error</span>
        <p>{{ error() }}</p>
        <button class="btn btn-primary" (click)="loadPosts()">Tentar novamente</button>
      </div>
    }

    @if (!isLoading() && !error()) {
      @if (pinnedPosts().length > 0) {
        <div class="pinned-section">
          <h3><span class="material-icons">push_pin</span> Posts Fixados</h3>
          @for (post of pinnedPosts(); track post.id) {
            <app-post-card 
              [post]="post" 
              [isPinned]="true"
              (deleted)="onPostDeleted($event)"
              (updated)="onPostUpdated($event)"
            ></app-post-card>
          }
        </div>
      }

      <div class="posts-section">
        @for (post of posts(); track post.id) {
          <app-post-card 
            [post]="post"
            (deleted)="onPostDeleted($event)"
            (updated)="onPostUpdated($event)"
          ></app-post-card>
        } @empty {
          <div class="empty-state">
            <span class="material-icons">article</span>
            @if (selectedFilter() === 'all') {
              <h3>Nenhum post ainda</h3>
              <p>Seja o primeiro a compartilhar algo!</p>
            } @else {
              <h3>Nenhum post nesta pastoral</h3>
              <p>Não há posts da {{ selectedFilter() === 'PA' ? 'Pastoral de Adolescentes' : 'Pastoral de Jovens' }} ainda.</p>
            }
          </div>
        }
      </div>
    }
  </div>
</div>
