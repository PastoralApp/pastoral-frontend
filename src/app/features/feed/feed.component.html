<div class="feed-container">
  <div class="feed-content">
    <div class="feed-filters">
      @for (filter of availableFilters(); track filter.tipo) {
        <button 
          class="filter-btn"
          [class.active]="selectedFilter() === filter.tipo || (selectedFilter() === null && filter.tipo === TipoPastoral.Geral)"
          (click)="setFilter(filter.tipo === TipoPastoral.Geral ? null : filter.tipo)"
        >
          <span class="material-icons">{{ filter.icon }}</span>
          {{ filter.label }}
        </button>
      }
    </div>

    <app-create-post (postCreated)="onPostCreated($event)"></app-create-post>

    @if (isLoading()) {
      <div class="loading-state">
        <div class="spinner"></div>
        <p>Carregando posts...</p>
      </div>
    }

    @if (!isLoading()) {
      @if (pinnedPosts().length > 0) {  
        <div class="pinned-section">
          <h3><span class="material-icons">push_pin</span> Posts Fixados</h3>
          @for (post of pinnedPosts(); track post.id) {
            <app-post-card 
              [post]="post" 
              [isPinned]="true"
              (deleted)="onPostDeleted($event)"
              (updated)="onPostUpdated($event)"
            ></app-post-card>
          }
        </div>
      }

      <div class="posts-section">
        @for (post of posts(); track post.id) {
          <app-post-card 
            [post]="post"
            (deleted)="onPostDeleted($event)"
            (updated)="onPostUpdated($event)"
          ></app-post-card>
        } @empty {
          <div class="empty-state">
            <span class="material-icons">article</span>
              @if (selectedFilter() === null || selectedFilter() === TipoPastoral.Geral) {
              <h3>Nenhum post ainda</h3>
              <p>Seja o primeiro a compartilhar algo!</p>
            } @else {
              <h3>Nenhum post nesta pastoral</h3>
              <p>Não há posts da {{ selectedFilter() === TipoPastoral.PA ? 'Pastoral de Adolescentes' : 'Pastoral de Jovens' }} ainda.</p>
            }
          </div>
        }
      </div>
    }
  </div>

  <aside class="feed-sidebar">
    <app-feed-sidebar></app-feed-sidebar>
  </aside>
</div>
