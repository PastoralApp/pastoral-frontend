<div class="evento-create">

  <div class="page-header mb-4">
    <div class="container">
      <div class="row align-items-center">
        <div class="col">
          <nav aria-label="breadcrumb">
            <ol class="breadcrumb mb-2">
              <li class="breadcrumb-item"><a routerLink="/eventos" class="text-decoration-none">Eventos</a></li>
              <li class="breadcrumb-item active">{{ isEditMode ? 'Editar' : 'Novo' }}</li>
            </ol>
          </nav>
          <h2 class="mb-0">
            <span class="material-icons align-middle me-2">{{ isEditMode ? 'edit' : 'event_note' }}</span>
            {{ isEditMode ? 'Editar Evento' : 'Novo Evento' }}
          </h2>
        </div>
      </div>
    </div>
  </div>

  <div class="container">
    <div class="row justify-content-center">
      <div class="col-lg-8">

        <div *ngIf="errorMessage" class="alert alert-danger d-flex align-items-center mb-4" role="alert">
          <span class="material-icons me-2">error</span>
          <div>{{ errorMessage }}</div>
        </div>

        <div class="card border-0 shadow-sm">
          <div class="card-body p-4">
            <form [formGroup]="eventoForm" (ngSubmit)="onSubmit()">

              <div class="mb-4">
                <label class="form-label fw-semibold">
                  <span class="material-icons align-middle me-1" style="font-size: 18px;">title</span>
                  Título do Evento
                </label>
                <input 
                  type="text" 
                  class="form-control form-control-lg" 
                  formControlName="title"
                  placeholder="Ex: Encontro de Jovens 2024"
                  [class.is-invalid]="eventoForm.get('title')?.invalid && eventoForm.get('title')?.touched">
                <div class="invalid-feedback">Título é obrigatório (mínimo 3 caracteres)</div>
              </div>

              <div class="mb-4">
                <label class="form-label fw-semibold">
                  <span class="material-icons align-middle me-1" style="font-size: 18px;">description</span>
                  Descrição
                </label>
                <textarea 
                  class="form-control" 
                  formControlName="description"
                  rows="5"
                  placeholder="Descreva o evento..."
                  [class.is-invalid]="eventoForm.get('description')?.invalid && eventoForm.get('description')?.touched"></textarea>
                <div class="invalid-feedback">Descrição é obrigatória (mínimo 10 caracteres)</div>
              </div>

              <div class="row g-3 mb-4">
                <div class="col-md-6">
                  <label class="form-label fw-semibold">
                    <span class="material-icons align-middle me-1" style="font-size: 18px;">event</span>
                    Data e Hora
                  </label>
                  <input 
                    type="datetime-local" 
                    class="form-control" 
                    formControlName="eventDate"
                    [class.is-invalid]="eventoForm.get('eventDate')?.invalid && eventoForm.get('eventDate')?.touched">
                  <div class="invalid-feedback">Data é obrigatória</div>
                </div>
                <div class="col-md-6">
                  <label class="form-label fw-semibold">
                    <span class="material-icons align-middle me-1" style="font-size: 18px;">location_on</span>
                    Local
                  </label>
                  <input 
                    type="text" 
                    class="form-control" 
                    formControlName="location"
                    placeholder="Ex: Salão Paroquial">
                </div>
              </div>

              <div class="row g-3 mb-4">
                <div class="col-md-6">
                  <label class="form-label fw-semibold">
                    <span class="material-icons align-middle me-1" style="font-size: 18px;">groups</span>
                    Máximo de Participantes
                  </label>
                  <input 
                    type="number" 
                    class="form-control" 
                    formControlName="maxParticipants"
                    min="0"
                    placeholder="0 = ilimitado">
                  <small class="text-muted">Deixe 0 para não limitar vagas</small>
                </div>
                <div class="col-md-6">
                  <label class="form-label fw-semibold d-block">
                    <span class="material-icons align-middle me-1" style="font-size: 18px;">how_to_reg</span>
                    Requer Inscrição
                  </label>
                  <div class="form-check form-switch mt-2">
                    <input 
                      class="form-check-input" 
                      type="checkbox" 
                      id="requireInscription"
                      formControlName="requireInscription">
                    <label class="form-check-label" for="requireInscription">
                      {{ eventoForm.get('requireInscription')?.value ? 'Sim, requer inscrição' : 'Não, evento aberto' }}
                    </label>
                  </div>
                </div>
              </div>

              <div class="d-flex justify-content-between align-items-center pt-3 border-top">
                <a routerLink="/eventos" class="btn btn-outline-secondary">
                  <span class="material-icons align-middle me-1" style="font-size: 18px;">arrow_back</span>
                  Cancelar
                </a>
                <button type="submit" class="btn btn-success px-4" [disabled]="loading || eventoForm.invalid">
                  <span *ngIf="loading" class="spinner-border spinner-border-sm me-2"></span>
                  <span *ngIf="!loading" class="material-icons align-middle me-1" style="font-size: 18px;">save</span>
                  {{ loading ? 'Salvando...' : (isEditMode ? 'Atualizar' : 'Criar Evento') }}
                </button>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
