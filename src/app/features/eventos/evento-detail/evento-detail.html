<div class="evento-detail">

  <div class="page-header mb-4">
    <div class="container">
      <nav aria-label="breadcrumb">
        <ol class="breadcrumb mb-2">
          <li class="breadcrumb-item"><a routerLink="/eventos" class="text-decoration-none">Eventos</a></li>
          <li class="breadcrumb-item active">{{ evento?.title || 'Detalhes' }}</li>
        </ol>
      </nav>
    </div>
  </div>

  <div class="container">

    <div *ngIf="loading" class="text-center py-5">
      <div class="spinner-border text-success" role="status">
        <span class="visually-hidden">Carregando...</span>
      </div>
    </div>

    <div *ngIf="!loading && evento" class="row justify-content-center">
      <div class="col-lg-8">
        <article class="card border-0 shadow-sm">
          <div class="card-body p-4 p-md-5">

            <div class="d-flex justify-content-between align-items-start mb-3">
              <span class="badge" [ngClass]="isPastEvent() ? 'bg-secondary' : 'bg-success'">
                {{ isPastEvent() ? 'Encerrado' : 'Ativo' }}
              </span>
              <span *ngIf="evento.requireInscription && !isPastEvent()" class="badge bg-primary">
                <span class="material-icons me-1" style="font-size: 12px;">how_to_reg</span>
                Inscrições Abertas
              </span>
            </div>

            <h1 class="evento-title mb-4">{{ evento.title }}</h1>

            <div class="evento-meta mb-4">
              <div class="row g-3">
                <div class="col-md-6">
                  <div class="d-flex align-items-center">
                    <span class="material-icons text-success me-2">calendar_today</span>
                    <div>
                      <small class="text-muted d-block">Data e Hora</small>
                      <span>{{ formatDate(evento.eventDate) }}</span>
                    </div>
                  </div>
                </div>
                <div class="col-md-6" *ngIf="evento.maxParticipants > 0">
                  <div class="d-flex align-items-center">
                    <span class="material-icons text-success me-2">groups</span>
                    <div>
                      <small class="text-muted d-block">Capacidade</small>
                      <span>{{ evento.maxParticipants }} participantes</span>
                    </div>
                  </div>
                </div>
                <div class="col-12" *ngIf="evento.location">
                  <div class="d-flex align-items-center">
                    <span class="material-icons text-success me-2">location_on</span>
                    <div>
                      <small class="text-muted d-block">Local</small>
                      <span>{{ evento.location }}</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <div class="evento-content mb-4">
              <h5 class="mb-3">
                <span class="material-icons align-middle me-1">description</span>
                Descrição
              </h5>
              <p class="text-muted" style="white-space: pre-line;">{{ evento.description }}</p>
            </div>

            <div *ngIf="evento.requireInscription && !isPastEvent()" class="registration-section mb-4 p-3 bg-light rounded">
              <div class="d-flex align-items-center justify-content-between flex-wrap gap-2">
                <div>
                  <h6 class="mb-1">Inscrição para este evento</h6>
                  <small class="text-muted">
                    {{ isRegistered ? 'Você já está inscrito neste evento' : 'Faça sua inscrição agora' }}
                  </small>
                </div>
                <div>
                  <button *ngIf="!isRegistered && canRegister()" 
                          class="btn btn-success"
                          (click)="registerForEvent()">
                    <span class="material-icons align-middle me-1">person_add</span>
                    Inscrever-se
                  </button>
                  <button *ngIf="isRegistered" 
                          class="btn btn-outline-danger"
                          (click)="unregisterFromEvent()">
                    <span class="material-icons align-middle me-1">person_remove</span>
                    Cancelar Inscrição
                  </button>
                </div>
              </div>
            </div>

            <div class="d-flex justify-content-between align-items-center pt-4 border-top">
              <a routerLink="/eventos" class="btn btn-outline-secondary">
                <span class="material-icons align-middle me-1">arrow_back</span>
                Voltar
              </a>
              <div class="d-flex gap-2" *ngIf="canEdit || canDelete">
                <a *ngIf="canEdit" [routerLink]="['/eventos/edit', evento.id]" class="btn btn-outline-success">
                  <span class="material-icons align-middle me-1">edit</span>
                  Editar
                </a>
                <button *ngIf="canDelete" class="btn btn-outline-danger" (click)="deleteEvento()">
                  <span class="material-icons align-middle me-1">delete</span>
                  Excluir
                </button>
              </div>
            </div>
          </div>
        </article>
      </div>
    </div>

    <div *ngIf="!loading && !evento" class="text-center py-5">
      <span class="material-icons text-muted mb-3" style="font-size: 64px;">event_busy</span>
      <h4 class="text-muted">Evento não encontrado</h4>
      <a routerLink="/eventos" class="btn btn-success mt-3">
        <span class="material-icons align-middle me-1">arrow_back</span>
        Voltar para Eventos
      </a>
    </div>
  </div>
</div>
